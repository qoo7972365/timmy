###該行在過濾pdf的時候沒有加上$符號，導致可以輸入.pdf.php達成繞過
  if (!preg_match("/\.pdf/", $file)) {

###應該在header那行，指定需要輸入三個參數，才不會使用到HS256較弱的算法
$parts = explode('.', $_GET['jwt']);
$algorithms = array('HS256', 'HS384', 'HS512');
if (3 !== count($parts)) {
  throw new \InvalidArgumentException('Invalid or malformed JWT supplied.');
}
$header = json_decode(self::decode($parts[0]), true);
if (in_array($header['alg'], $algorithms)) {
  ...
}


###PHP在比對JWT token的時候，可以使用..來繞過
    if (!empty($sign) and (JWT::signature($h64.".".$d64) != $sign)) {

###有對SQL注入做檢測，但是直接回傳顯示了mysql_error()報錯，可能導致報錯包含SQL訊息，通常可以使用超過256的帳號名稱來達成漏洞
	function register($user, $hashed_password) {
  $sql = "INSERT INTO  users (login,password) values (\"";
  $sql.= mysql_real_escape_string($user);
  $sql.= "\", \"";
  $sql.= mysql_real_escape_string($hashed_password);
  $sql.= "\")";
  $result = mysql_query($sql);
  if ($result) {
    return TRUE;
  }
  else
    echo mysql_error();
  return FALSE;
}

###沒有對'作過濾，可以在username中加入'阻斷語句，達成xss
<a href='/profile/<?php echo htmlentities($user); ?>'></a>

###可以透過輸入1;ls達成command injection
 if (isset($_GET["count"]) and 
            ($_GET["count"] > 0) and
            ($_GET["count"] <= 4)) {
    echo system("ping pentesterlab.com -c ".$_GET['count']);
  } 

###可以透過參數造成null=null繞過
   define('KEY', '...');
  function sign($data) {
    return hash_hmac('sha256', $data, KEY);
  } 
  if (isset($_GET["data"]) and
      sign($_GET["data"]) === $_GET["signature"]) {
      echo "Valid Signature";
      //...
  } else {
    die("Invalid Signature");
  } 

###php中對比較的時候，如果==可以繞過，因爲只比較值，不比較類型，通常可輸入空格繞過
    define('KEY', '...');
  function sign($data) {
    return hash_hmac('sha256', $data, KEY);
  } 
  if (isset($_GET["data"]) and
      isset($_GET["signature"]) and
      sign($_GET["data"]) == $_GET["signature"]) {
      echo "Valid Signature";
      //...
  } else {
    die("Invalid Signature");
  } 