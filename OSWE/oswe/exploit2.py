#!/user/bin/python3
import binascii
import requests
import hashlib
import sys
from Cryptodome.Cipher import DES3
from Crypto.Util.Padding import pad
from bs4 import BeautifulSoup


BLOCK_SIZE = 8
enc_key=[5,111,155,65,232,110,245,84,105,100,181,46,13,235,159,245,98,212,82,15,102,45,30,250]
byte_enc_key=bytearray(enc_key)
byte_enc_key=binascii.hexlify(byte_enc_key).decode('utf-8')
byte_enc_key=byte_enc_key.upper()
#print(byte_enc_key)

sha_key=hashlib.sha512()
sha_key.update(str(byte_enc_key).encode('utf-8'))
sha_key=sha_key.hexdigest()

new_key=binascii.unhexlify(sha_key[0:48])
cipher = DES3.new(new_key, DES3.MODE_ECB)

authType="DNNx"
authType_enc=cipher.encrypt(pad(authType.encode('utf-8'),BLOCK_SIZE))
authType_enc=binascii.b2a_base64(authType_enc)
sys.stdout.write("Type: "+authType_enc.rstrip().decode('utf-8'))
